\subsection{Использование АР для детектирования ШПС}
\label{ssec:lpc}
Известно, что АР подход широко применяется в детектировании и кодировании голоса и видео, в восстановлении сигналов и т.д.
Более точно - АР-модели целесообразно применять для получения спектров с острыми пиками, но без глубоких впадин (нулей).
Так же в пользу выбора АР-модели может быть принят тот факт, что часто вычислительные затраты для оценивания АР-модели 
ниже чем вычислительные затраты требуемые для оценки параметров СС- и АРСС моделей \cite{marpl_book}.

Специфичной для детектирования ШПС является необходимость определения точной фазы ПСП
для работы с сигналом. Так же при обработке ШПС от нескольких источников с разными ПСП необходимо учитывать,
что оценка спектра будет смещенной и требуется его корректировка. Следует учитывать, что после демодуляции
с синхронизированной копией ПСП получается гармоничнская компонента и шум. Подробнее компоненты шума были
рассмотрены в \ref{l:noise_model}. Преобразуем выражение \ref{eq:gps_signal_modulated}: амплитуду гармонического
сигнала возьмем ${\sqrt{2A} = 1}$, ${D_k(t)}$ примем за 1, учитывая, что мы детектируем сигнал в пределах одного
чипа:
\begin{center}
\begin{equation}
	\label{eq:lpc_signal}
	s(t) = \cos(\omega_{c}t) + n(t)
\end{equation}
\end{center}

Для уравнения \ref{eq:lpc_rms2}, необходимо записать ковариации для 3 точек
${r_{xx}(0)}$, ${r_{xx}(1)}$, ${r_{xx}(2)}$:

\begin{center}
\begin{equation}
	\label{eq:lpc_cov}
	{r_{xx}(\tau) = \frac{1}{N} \sum \limits_{n=0}^{N-1} x(n) x(n-\tau)}
\end{equation}
\end{center}

Для применения АР метода является очень существенным знать модель шумовой компоненты из ${n(t)}$ из выражения
\ref{eq:lpc_signal}. Зная АКФ ${n(t)}$, можно получить несмещенную оценки ${\omega_c}$.

\subsubsection{Детектирование ШПС от одного источника}

Рассмотрим простейший случай - применение данного подхода для детектирования одного сигнала ШПС.
Схема алгоритма представлена на рисунке \ref{pic:lpc_basic1}

\begin{figure}[H]
	\center\scalebox{0.8}{\includegraphics[width=1\linewidth]{lpc_basic.eps}}
	\caption{Общая схема применения АР модели для детектирования ШПС сигнала}
	\label{pic:lpc_basic1}
\end{figure}

На \ref{pic:lpc_basic1} входной сигнал повторно модулируется ПСП с известной фазой. В результате восстанавливается гармонический сигнал.
Для детектирования этого сигнала можно применить АР метод. Но в реальной ситуации приемовычислитель не знает текущую фазу кода и необходимо ее найти.
Повторная модуляция сигнала с ПСП по любой фазе отличной от искомой не будет восстанавливать гармонический сигнал.
Спектр гармонического сигнала повторно модулированного ПСП с невыровненной фазой будет такой же, как у исходного сигнала – отображен
на рисунке \ref{pic:lpc_psd_1} штриховой пунктирной линией. И только повторная модуляция с выровненной фазой ПСП даст спектр
изображенный красной линией на рисунке \ref{pic:lpc_psd_1}.

\begin{figure}[H]
	\center\scalebox{0.8}{\includegraphics[width=1\linewidth]{lpc.eps}}
	\caption{Общая схема применения АР модели для детектирования ШПС сигнала}
	\label{pic:lpc_basic2}
\end{figure}

Для перебора фаз ПСП воспользуемся БПФ, в результате получим значения оценки АКФ для каждой фазы ПСП (глава \ref{sec1_fft}).
Схема алгоритма представлена на рисунке \ref{pic:lpc_basic2}. 

Поскольку повторная модуляция ПСП восстанавливает единственную гармоническую компоненту,
необходимо искать 1 частоту - 2 полюса.  Тогда выражение \ref{eq:lpc_rms2} может быть записано как:
\begin{center}
\begin{equation}
	\label{eq:lpc_gps_1}
	{\bf a} = 
		\left[ \begin{array}{cc}
			r_{xx}(0) & r_{xx}(1) \\
			r_{xx}(1) & r_{xx}(0)
		\end{array} \right]
		\left[ \begin{array}{c}
			r_{xx}(1) \\
			r_{xx}(2)
		\end{array} \right]
\end{equation}
\end{center}

После получения коэффициентов АР модели ${\bf{a}}$, необходимо вычислить полюса передаточной функции:
\begin{center}
\begin{equation}
	\label{eq:lpc_spectral_func}
	%H(e^{j \omega}) = \frac{1}{-a_2 e^{-2j \omega} - a_1e^{-j \omega} + 1}
	H(z) = \frac{1}{1 - a_1 z^{-1} - a_2 z^{-2}}
\end{equation}
\end{center}

Выходом алгоритма будет СПМ, а пик будет соответствовать энергии на определенной частоте. На рисунке
\ref{pic:lpc_poles_gps} красным изображена энергия гармонического колебания с большой мощностью, а
зеленым изображен цветной шум.
\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_poles_gps.eps}}
	\caption{Полюс и АЧХ линейного предсказателя}
	\label{pic:lpc_poles_gps}
\end{figure}

можно построить график оценки СПМ для смещения,
содержащего максимальный спектральный пик - гармоническую компоненту
с наивысшей энергией - рисунок \ref{pic:lpc_psd_1} и график состоящий из максимальных спектральных пиков для каждой фазы
ПСП - рисунок \ref{pic:lpc_1sat_energy}.

\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_1sat.eps}}
	\caption{Оценка СПМ сигнала модулированного ПСП}
	\label{pic:lpc_psd_1}
\end{figure}
\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_1sat_energy.eps}}
	\caption{Максимальные пики для каждой фазы ПСП}
	\label{pic:lpc_1sat_energy}
\end{figure}

Алгоритм представленный на схеме \ref{pic:lpc_basic} можно описать следующей последовательностью действий:
\begin{itemize}
	\item[Шаг 1] Вычисление АКФ с ${\tau = 0, 1, 2}$ по формуле \ref{eq:lpc_cov} сигнала и ПСП;
	\item[Шаг 2] Вычисление свертки сигнала и ПСП с помощью БПФ для каждой из полученных последовательностей
			на первом шаге. При присутствии в данных сигнала, на одном из смещений после
			повторной модуляции сигнала с помощью ПСП будет искомый гармонический сигнал;
	\item[Шаг 3.1] Для каждого возможного смещения вычисляются коэффициенты ${\bf{a}}$ по формуле
			\ref{eq:lpc_gps_1};
	\item[Шаг 3.2] Вычисляется полюс и резонансная частота по формулам \ref{eq:lpc_poles} и \ref{eq:lpc_poles_freq};
	\item[Шаг 4] Решающий модуль делает заключение о присутствии или отсутсвии сигнала по величине
			максимального спектрального пика по всем возможным смещениям ПСП;
	\item[Шаг 5] Вычисляется значение квадрата модуля частотного отклика АР модели для резонансной частоты.
			Полученное значение сравнивается с порогом для принятия решения о наличии сигнала.
\end{itemize}

Но любой шум, отличный АБГШ будет смещать оценку частоты. На рисунке \ref{pic:lpc_1sat_interference}
представлен график смещения оценки в зависимости от мощности второго луча сигнала, модулированного
той же ПСП.

\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_interference.eps}}
	\caption{Зависимость ошибки оценки пика от энергии интерференционной помехи}
	\label{pic:lpc_1sat_interference}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Детектирование ШПС с коррекцией шума}

Для детектирования слабых сигналов, необходимо знать природу шума. Тепловой шум является одинаковым для всех источников,
таким образом его можно получить от других приемников или рассчитать в процессе детектирования. 

Для некоторых существующих систем на основе сигналов, модулированных ПСП, можно использовать приемники находящиеся рядом,
ввиду, что приемников данного сигнала достаточно большое количество. В качестве примера можно взять сигнал Navstar GPS
для приемников. Достаточно большое количество приемников GPS, захвативших сигнал, находится вблизи приемника, который
только начинает процедуру детектирования сигнала. По такой схеме работает система AGPS (Assistance GPS). Так же по данной
схеме работает система, разработанная в процессе моих исследований. Эта система отражена в заявке на изобретение
\cite{patent_my}.

\begin{center}
\begin{equation}
	\label{eq:lpc_gps_1}
	{\bf a} = 
		\left(
			\left[ \begin{array}{cc}
				r_{xx}(0) & r_{xx}(1) \\
				r_{xx}(1) & r_{xx}(0)
			\end{array} \right] -
			\left[ \begin{array}{cc}
				n_{xx}(0) & n_{xx}(1) \\
				n_{xx}(1) & n_{xx}(0)
			\end{array} \right] 
		\right)
		\left[ \begin{array}{c}
			r_{xx}(1) \\
			r_{xx}(2)
		\end{array} \right]
\end{equation}
\end{center}


\newpage
