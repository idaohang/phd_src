\subsection{АР-модель случайного процесса. Оценка параметров АР-модели}

Модель линейного предсказателя может быть описана как взвешенная сумма ${P}$ предыдущих отсчетов сигнала:
\begin{center}
\begin{equation}
	\label{eq:lpc_forecast}
	\hat{x}(m) = \sum \limits_{k=1}^P a_k x(m-k),
\end{equation}
\end{center}
Где ${\hat{x}(m)}$ - оценка ${x(m)}$ в момент времени ${m}$, а ${a_k}$ - коэффициенты линейного предсказателя.

Ошибка предсказания ${e(m)}$ может быть представлена как разность между принятым семплом и его
предсказанным значением:
\begin{center}
\begin{equation}
	\label{eq:lpc_error}
	e(m) = x(m) - \hat{x}(m) = x(m) - \sum \limits_{k=1}^P a_k x(m-k),
\end{equation}
\end{center}

Из уравнения \ref{eq:lpc_error} смоделированный сигнал может быть представлен следующим рекурсивным соотношением:
\begin{center}
\begin{equation}
	\label{eq:lpc_signal}
	x(m) = \sum \limits_{k=1}^P a_k x(m-k) + e(m)
\end{equation}
\end{center}

Выражение \ref{eq:lpc_error} соответствует структуре выражения АР-модели при замене ошибки предсказания ${e(m)}$ на АБГШ.
Так же следует учесть, что входом линейного предсказателя является последовательность ${x(m)}$, а выходом ${e(m)}$.
В АР-модели выхдом является последовательность ${x(m)}$. Коэффициенты ${a_k}$ идентичны.
В виду этого существует тесная связь между фильтром линейного предсказания и АР-моделью \cite{marpl_book}.

Уравнение \ref{eq:lpc_error} представляет собой цифровой фильтр.
После ${z}$ - преобразования уравнение \ref{eq:lpc_signal} может быть записано как \cite{saeed_book}:
\begin{center}
\begin{eqnarray}
	\label{eq:lpc_z}
		H(z)	& = & \frac{X(z)}{U(z)} = \frac{G}{1 - \sum \limits_{k=1}^P a_kz^{-k}} =  \nonumber \\
			& = & G\frac{1}{\prod \limits_{k=1}^N (1-r_kz^{-1})} \frac{1}{\prod \limits_{k=1}^M (1-2r_k \cos \phi_k z^{-1} + r_k^2z^{-2})}
\end{eqnarray}
\end{center}

В уравнении \ref{eq:lpc_z} ${M}$ - пар комплексных полюсов, ${N}$ - действительные полюсы с ${P=N+2M}$,
${r_k}$ и ${\phi_k}$ - радиус и угол ${k}$ - го полюса соответственно. Частотный отклик такой системы 
может быть представлен \cite{saeed_book}:
\begin{center}
\begin{eqnarray}
	\label{eq:lpc_freq_resp}
		H(f)	& = & = \frac{G}{1 - \sum \limits_{k=1}^P a_k e^{-j2 \pi kf}} =  \nonumber \\
			& = & G\frac{1}{\prod \limits_{k=1}^N (1-r_k e^{-j2 \pi f)}} \frac{1}{\prod \limits_{k=1}^M (1-2r_k \cos \phi_k e^{-j2 \pi f} + r_k^2 e^{-j4 \pi f})}
\end{eqnarray}
\end{center}

На рисунке \ref{pic:lpc_poles} изображено отношение между полюсами и АЧХ рекурсивного фильтра. На частотах, соответствующих полюсам,
на графике АЧХ приаргумент комплексного полюса сутствуют частотные пики. Пары комплексных корней могут быть представлены через радиус ${r_k}$ и угол ${\phi_k}$
полюса:

\begin{center}
\begin{equation}
	\label{eq:lpc_poles}
	z_k = r_k e^{\pm j \phi_k}
\end{equation}
\end{center}

Резонансные частоты выражаются через комплексные полюса как:
\begin{center}
\begin{equation}
	\label{eq:lpc_poles_freq}
	F(\phi_k)=\frac{F_s}{2 \pi} \phi_k
\end{equation}
\end{center}
где ${F_s}$ - частота оцифровки, ${\phi_k}$ - аргумент комплексного полюса ${z_k}$ передаточной функции \ref{eq:lpc_z}.

\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_poles.eps}}
	\caption{Полюса и АЧХ линейного предсказателя}
	\label{pic:lpc_poles}
\end{figure}

\paragraph{Вычисление коэффициентов АР модели}
Наилучшие оценки коэффициентов ${a_k}$ могут быть получены минимизацией среднеквадратичной ошибки уравнения\cite{saeed_book}
\ref{eq:lpc_error}:
\begin{center}
\begin{eqnarray}
	\label{eq:lpc_rms}
		E[e^2(m)]	& = & E[(x(m) - \sum \limits_{k=1}^P a_k x(m-k))^2] =\nonumber \\
				& = & E[x^2(m)] - \nonumber \\
				& &  - 2\sum \limits_{k=1}^P a_k E[x(m-k)x(m)] + \nonumber \\
				& &  + \sum \limits_{k=1}^P a_k \sum \limits_{j=1}^P a_j E[x(m-k)x(m-j)] = \nonumber \\
				& = & r_{xx}(0) - 2{\bf r}^T_{xx}{bf a} + {\bf a}^T {\bf R_{xx}a}
\end{eqnarray}
\end{center}
Где ${{\bf R_{xx}} = E[{\bf xx}^T]}$ - это автокорреляционная матрица входного вектора ${{\bf x}^T=[x(m-1),x(m-2),...,x(m-P)]}$,
${{\bf r}_{xx}=E[x(m){\bf x}]}$ - автокорреляционный вектор, а ${a^T=[a_1,a_2,...,a_P]}$ -  вектор коэффициентов предсказателя.
Минимизация среднеквадратичной ошибки из уравнения \ref{eq:lpc_rms} может быть записано как:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms2}
	{\bf a=R^{-1}_{xx}r_{xx}}
\end{equation}
\end{center}

Можно использовать альтернативную запись.
Для сигнала длинной в ${N}$ семплов можно записать ${N}$ - уравнений:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms3}
	{\bf e=x-Xa}
\end{equation}
\end{center}
Уравнение \ref{eq:lpc_rms3} можно переписать в виде:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms4}
	{\bf eу^T = xx^T - 2x^T Xa + a^T X^T Xa}
\end{equation}
\end{center}

Взяв производную по вектору ${{\bf a}}$, можно получить параметры предсказателя:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms5}
	\frac{\partial {\bf e^T e}}{\partial {\bf a}} = {\bf - 2x^T X + a^T X^T X} = 0
\end{equation}
\end{center}
Из \ref{eq:lpc_rms6}, коэффициенты для минимальной среднеквадратичной ошибки равны:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms6}
	{\bf a= (X^T X)^{-1} (X^T x)}
\end{equation}
\end{center}

Из сравнения уравнений \ref{eq:lpc_rms2} и \ref{eq:lpc_rms6} видно, что в \ref{eq:lpc_rms2}
автокорреляционная матрица и вектор заменены оценками:
\begin{center}
\begin{equation}
	\label{eq:lpc_rms7}
	\hat{r}_{xx}(m) = \frac{1}{N} \sum \limits_{k=0}^{N-1} x(k)x(k-m)
\end{equation}
\end{center}

Уравнения \ref{eq:lpc_rms2} и \ref{eq:lpc_rms7} могут быть эффиктивно решены с помощью регулярных
Тёплицевых структур корреляционной матрицы ${{\bf R_{xx}}}$. Эффективным алгоритмам над Тёплицевыми
матрицами посвещена книга \cite{bleyhut_book} \textcolor{red}{<== А ЭТО НУЖНО????} Эффективным методом решения
данных соотношений является алгоритм Левинсона-Дарби.

АР метод оценивания СПМ часто используется для того, чтобы выявить в данных наличие синусоидальных
компонент. Мощность, соответствующую  таким компонентам в АР оценке СПМ, можно вычислить, интегрируя
площадь под кривой этой оценки. Однако это связано с большими вычислительными затратами, поэтому
гораздо более эффективным является использования в качестве показателя мощности синусоидальных
компонент высоты соответствующих им спектральных пиков \cite{marpl_book}.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{АР модель второго порядка. Оценка частоты основного тона на основе АР-модели}
АР-модель второого порядка применяется для определения частоты основого тона. Для поиска единственного
тона необходимо найти 2 полюса. Тогда выражение \ref{eq:lpc_rms2} может быть записано как:

\begin{center}
\begin{equation}
	\label{eq:lpc_gps_1}
	\left[ \begin{array}{c}
		\hat{a}_1 \\
		\hat{a}_2
	\end{array} \right]
	=
		\left[ \begin{array}{cc}
			r_{xx}(0) & r_{xx}(1) \\
			r_{xx}(1) & r_{xx}(0)
		\end{array} \right]^{-1}
		\left[ \begin{array}{c}
			r_{xx}(1) \\
			r_{xx}(2)
		\end{array} \right]
	= R_x^{-1}r_{xx1}
\end{equation}
\end{center}

Здесь ${\hat{a}_1, \hat{a}_2}$, - МНК оценки коэффициентов модели, ${r_{xx}(m)}$ - АКФ принимаемого сигнала.
Для оценки АКФ  можно использовать выражение:

\begin{center}
\begin{equation}
	\label{eq:lpc_rxx_estimation}
	\hat{r}_{xx}(m) = \frac{1}{N-1} \sum \limits_{k=0}^{N-1} x(k)x(k-m)
\end{equation}
\end{center}

Передаточная функция АР-модели второго порядка ${H(z)}$:
\begin{center}
\begin{equation}
	\label{eq:lpc_spectral_func}
	H(z) = \frac{1}{1 - a_1 z^{-1} - a_2 z^{-2}}
\end{equation}
\end{center}

Для определения резонансной частоты ${H(z)}$ можно воспользоваться формулой \ref{eq:lpc_poles_freq}.
Для принятия решения о наличии гармонического сигнала анализируют значение квадрата модуля частотной
характеристики АР-модели в точке резонанса:

\begin{center}
\begin{equation}
	\label{eq:lpc_power_cos}
	\left| H(z) \right|^2 = \frac{1}{\left| 1 - a_1 e^{-j \omega_0} - a_2 e^{-2 \omega_0} \right|^2}
\end{equation}
\end{center}

Если это значение превышает некоторый заранее выбранный порог, то принимается решение о наличии гармонического
сигнала с частотой  . 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Использование АР-модели для детектирования ШПС}

При работе с ПСП следует учитывать, что после демодуляции входного сигнала выровненной ПСП в сигнале восстанавливается 1 гармоническая
компонента, что дает возможность использовать АР-модель второго порядка.
Повторная модуляция сигнала с ПСП по любой фазе отличной от искомой не будет восстанавливать гармонический сигнал.
Спектр гармонического сигнала повторно модулированного ПСП с невыровненной фазой будет такой же, как у исходного сигнала – отображен
на рисунке \ref{pic:lpc_psd_1} штриховой пунктирной линией. И только повторная модуляция с выровненной фазой ПСП даст спектр
изображенный красной линией на рисунке \ref{pic:lpc_psd_1}.

На \ref{pic:lpc_basic1} входной сигнал повторно модулируется ПСП с известной фазой.

\begin{figure}[H]
	\center\scalebox{0.8}{\includegraphics[width=1\linewidth]{lpc_basic.eps}}
	\caption{Общая схема применения АР-модели для детектирования ШПС сигнала}
	\label{pic:lpc_basic1}
\end{figure}

Выходом алгоритма будет СПМ, а пик будет соответствовать энергии на определенной частоте. На рисунке
\ref{pic:lpc_poles_gps} красным изображена энергия гармонического колебания с большой мощностью, а
зеленым изображен цветной шум.
\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_poles_gps.eps}}
	\caption{Полюс и АЧХ линейного предсказателя}
	\label{pic:lpc_poles_gps}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Детектирование ШПС от одного источника}
Пусть входной сигнал после снятия кода может быть представлен в виде:

\begin{center}
\begin{equation}
	\label{eq:lpc_signal_model}
	x(k)=A \cos{(\omega k)} + n(k)
\end{equation}
\end{center}

где ${n(k)}$ - АБГШ помеха. Тогда оценка АКФ сигнала ${x(k)}$:

Для уравнения \ref{eq:lpc_gps_1}, необходимо вычислить ковариации для 3 точек
${r_{xx}(0)}$, ${r_{xx}(1)}$, ${r_{xx}(2)}$, используя выражение \ref{eq:lpc_rxx_estimation}.

Можно построить график оценки СПМ для смещения,
содержащего максимальный спектральный пик - гармоническую компоненту
с наивысшей энергией - рисунок \ref{pic:lpc_psd_1} и график состоящий из максимальных спектральных пиков для каждой фазы
ПСП - рисунок \ref{pic:lpc_1sat_energy}.

\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_1sat.eps}}
	\caption{Оценка СПМ сигнала модулированного ПСП}
	\label{pic:lpc_psd_1}
\end{figure}
\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_1sat_energy.eps}}
	\caption{Максимальные пики для каждой фазы ПСП}
	\label{pic:lpc_1sat_energy}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Влияние теплового шума на точность детектирования с помощью АР модели}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Влияние интерференции на точность детектирования с помощью АР модели}

Шум, отличный АБГШ будет смещать оценку частоты. На рисунке \ref{pic:lpc_2sat_psd} показано
смещение для интерференционной помехи от еще одного источника сигнала, модулированной ПСП того же семейства.
Данная помеха не является белой и оценка АР-методом по предложенному алгоритму не даст надежной оценки частоты сигнала.

\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_2sat_psd.eps}}
	\caption{СПМ для сигнала с интерференционной помехой}
	\label{pic:lpc_2sat_psd}
\end{figure}

\subsection*{Выводы}

%%%%%%%%%%%%%%%%%%5
% OLD
%%%%%%%%%%%%%%%%%%5

\subsection*{\textcolor{red}{Старый текст для переноса!!!!!!!!!}}

\subsubsection{Влияние теплового шума на точность детектирования с помощью АР модели}
%Для применения АР метода является очень существенным знать модель шумовой компоненты из ${n(t)}$ из выражения
%		r_{xx}(2)
%\ref{eq:lpc_signal}. Зная АКФ ${n(t)}$, можно получить несмещенную оценки ${\omega_c}$.

\subsubsection{Детектирование ШПС от одного источника}


Но любой шум, отличный АБГШ будет смещать оценку частоты. На рисунке \ref{pic:lpc_1sat_interference}
представлен график смещения оценки в зависимости от мощности второго луча сигнала, модулированного
той же ПСП.

\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc_interference.eps}}
	\caption{Зависимость ошибки оценки пика от энергии интерференционной помехи}
	\label{pic:lpc_1sat_interference}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Детектирование ШПС с коррекцией шума}

Для детектирования слабых сигналов, необходимо знать природу шума. Тепловой шум является одинаковым для всех источников,
таким образом его можно получить от других приемников или рассчитать в процессе детектирования. 

Для некоторых существующих систем на основе сигналов, модулированных ПСП, можно использовать приемники находящиеся рядом,
ввиду, что приемников данного сигнала достаточно большое количество. В качестве примера можно взять сигнал Navstar GPS
для приемников. Достаточно большое количество приемников GPS, захвативших сигнал, находится вблизи приемника, который
только начинает процедуру детектирования сигнала. По такой схеме работает система AGPS (Assistance GPS). Так же по данной
схеме работает система, разработанная в процессе исследований. Эта система отражена в заявке на изобретение
\cite{patent_my}.

\begin{center}
\begin{equation}
	\label{eq:lpc_a_estimation}
	\left[ \begin{array}{c}
		\hat{a}_1 \\
		\hat{a}_2
	\end{array} \right]
		=
		\left(
			\left[ \begin{array}{cc}
				r_{xx}(0) & r_{xx}(1) \\
				r_{xx}(1) & r_{xx}(0)
			\end{array} \right] -
			\left[ \begin{array}{cc}
				n_{xx}(0) & n_{xx}(1) \\
				n_{xx}(1) & n_{xx}(0)
			\end{array} \right] 
		\right)
		\left[ \begin{array}{c}
			r_{xx}(1) \\
			r_{xx}(2)
		\end{array} \right]
		=
		R_x^{-1}r_{xx1}
\end{equation}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Детектирование ШПС с коррекцией шума}
Точность АР метода напрямую зависит от точности оценки АКФ гармонического сигнала. Основным способом повышения точности оценки
АКФ является увеличение размера выборки, что в случае модулированного сигнала может быть затруднительным. В данной работе
предлагается алгоритм оценки АКФ гармонического сигнала, не требующий увеличения длины или накопления сигнала.
Повышение точности достигается за счет того, что АКФ гармонического сигнала представляет собой гармонический сигнал той же частоты.
Пусть входной сигнал после снятия кода может быть представлен в виде:

\begin{center}
\begin{equation}
	%\label{eq:lpc_gps_1}
	x(k)=A \cos{(\omega_k)} + n(k)
\end{equation}
\end{center}

где ${n(k)}$ - АБГШ помеха. Тогда оценка АКФ сигнала ${x(k)}$:


\begin{center}
\begin{equation}
	%\label{eq:lpc_gps_1}
	r_1 = F^{-1}[Fx \cdot Fx]
\end{equation}
\end{center}

где ${F}$ - матрица преобразования Фурье, ${F^{-1}}$ - обратная матрица преобразования Фурье, ${x}$ - вектор входного сигнала,
демодулированного ПСП, а (${\cdot{}}$) - знак означает поэлементное перемножение векторов.

\begin{center}
\begin{equation}
	%\label{eq:lpc_gps_1}
	r_1 = F^{-1} \left[ F\left[F^{-1}\left[Fx \cdot Fx\right]\right] \cdot F\left[F^{-1}\left[Fx \cdot Fx\right]\right] \right]
\end{equation}
\end{center}

Специфичной для детектирования ШПС является необходимость определения точной фазы ПСП
для работы с сигналом. Так же при обработке ШПС от нескольких источников с разными ПСП необходимо учитывать,
что оценка спектра будет смещенной и требуется его корректировка. Следует учитывать, что после демодуляции
с синхронизированной копией ПСП получается гармоничнская компонента и шум. Подробнее компоненты шума были
рассмотрены в \ref{l:noise_model}. Преобразуем выражение \ref{eq:gps_signal_modulated}: амплитуду гармонического
сигнала возьмем ${\sqrt{2A} = 1}$, ${D_k(t)}$ примем за 1, учитывая, что мы детектируем сигнал в пределах одного
чипа:
\begin{center}
\begin{equation}
	\label{eq:lpc_signal}
	s(t) = \cos(\omega_{c}t) + n(t)
\end{equation}
\end{center}

Специфичной для детектирования ШПС является необходимость определения точной фазы ПСП
для работы с сигналом. Так же при обработке ШПС от нескольких источников с разными ПСП необходимо учитывать,
что оценка спектра будет смещенной и требуется его корректировка. Следует учитывать, что после демодуляции
с синхронизированной копией ПСП получается гармоничнская компонента и шум. Подробнее компоненты шума были
рассмотрены в \ref{l:noise_model}. Преобразуем выражение \ref{eq:gps_signal_modulated}: амплитуду гармонического
сигнала возьмем ${\sqrt{2A} = 1}$, ${D_k(t)}$ примем за 1, учитывая, что мы детектируем сигнал в пределах одного
чипа:
\begin{center}
\begin{equation}
	\label{eq:lpc_signal}
	s(t) = \cos(\omega_{c}t) + n(t)
\end{equation}
\end{center}

\newpage
