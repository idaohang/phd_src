\section{Эффективная релизация алгоритмов детектирования и оценки параметров ШПС}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Алгоритм обнаружения ШПС с использованием процедуры БПФ}

В разделе \ref{ssec:lpc_conclusion} было отмечено, что алгоритм детектирования и оценки параметров
требует значительных вычислительных затрат. В данной работе предлагается способ оптимизации алгоритма,
описанного в разделе \ref{ssec:lpc_cdma_detect}.

Для перебора фаз ПСП воспользуемся БПФ, в результате получим значения оценки АКФ для каждой фазы ПСП (глава \ref{sec1_fft}).
Схема алгоритма представлена на рисунке \ref{pic:lpc_basic2}. 

\begin{figure}[H]
	\center\scalebox{1}{\includegraphics[width=1\linewidth]{lpc.eps}}
	\caption{Схема применения АР-модели для детектирования ШПС сигнала с оптимизацией}
	\label{pic:lpc_basic2}
\end{figure}

Оценка ${\hat{r}_{xx}(0)}$ не зависит от выбранной фазы ПСП, поэтому она вычисляется один
раз для всех смещений кода. Далее формируется массив произведений входного сигнала на
свою задержанную копию ${\tilde{x}_1(n)=x(n)x(n-1)}$. Полученная последовательность  
${\tilde{x}_1(n)}$ поступает на вход алгоритма БПФ, в результате получаем массив ${\tilde{X}_1(n)}$
содержащий частотные отсчеты. Аналогично формируется массив  ${\tilde{X}_2(n)}$ для
задержки входного сигнала равной двум. Таким же способом обрабатываются локально
сгенерированные ПСП и формируются два массива ${\tilde{C}_1(n)}$ и ${\tilde{C}_2(n)}$.
Далее массивы ${\tilde{X}_1(n)}$ и ${\tilde{X}_1(n)}$ поэлементно перемножаются
на комплексно сопряженные массивы ${\tilde{C}_1^*(n)}$ и ${\tilde{C}_2^*(n)}$.
Результаты этих перемножений поступают на вход алгоритма обратного
БПФ. Полученные после ОБПФ два массива содержат оценки автокорреляционной функции для ${N}$ 
смещений кода, где  ${N}$ - размер данных на входе алгоритма БПФ.

Таким образом, предлагаемый алгоритм состоит из следующих шагов:

\begin{itemize}
\item[Шаг 1.] Вычисляются оценки  АКФ в трех первых точках (для аргументов АКФ=0,1,2)
	с использованием алгоритма БПФ для всех возможных смещений ПСП. 
\item[Шаг 2.] Для каждого смещения ПСП: 
	Определяются коэффициенты АР-модели ${\hat{a_1}, \hat{a_2}}$, 
	по формуле \ref{eq:lpc_a_estimation}. 
	Вычисляется резонансная частота ${\omega_0}$
	и определяется квадрат модуля частотного отклика АР-модели для этой частоты. 
\item[Шаг 3.] Выбирается смещение ПСП для которого значение квадрата модуля частотного отклика было максимальным. Полученное значение сравнивается с заранее выбранным порогом детектора. 
	\subitem{\bf{Если}}  значение оказалось больше порогового {\bf{то}} 
		принимается решение о наличии сигнала, а в качестве оценки
		частоты принимается значение ${\omega_0}$ соответствующее выбранному смещению ПСП. 
	\subitem{\bf{Иначе}} 
		Принимается решение об отсутствии гармонического сигнала.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Подавление интерференции. Алгоритм уточнения оценки АКФ гармонического сигнала.
		Дисперсия оценки АКФ по уточненному алгоритму}

Точность АР метода напрямую зависит от тоности оценки АКФ гармонического сигнала. Основным способом повышения точности оценки АКФ является увеличение размера выборки,
что в случае модулированного сигнала может быть затруднительным.В данной работе предлагается использовать алгоритм увеличения ОСШ методом последовательного вычисления
АКФ \cite{ostanin_akf}.

Посчитаем АКФ для выражения \ref{eq:lpc_signal_model}.

\begin{center}
\begin{equation}
	\label{eq:lpc_akf_n}
	\hat{r}_{xx}(n) = \sum \limits_{k=1}^{K} x(k)x(k+n) = \frac{A^2}{2} \cos{(\omega{n})} \Delta_n \delta{(n)} + \mu{(n)}
\end{equation}
\end{center}

Здесь ${\Delta_n}$ - дисперсия шума ${n(k)}$. ${\mu{(n)}}$ - ошибка оценки АКФ. ${\delta{(n)}}$ - дельта-функция. исперсия ошибки
оценки ${\Delta_{\mu}}$ будет в ${K}$ раз меньше чем дисперсия ${\Delta_n}$ шума в принимаемом сигнале, где ${K}$ - интервал
осреднения оценки АКФ.

Используя оценку АКФ вместо исходной выборки, вновь получим оценку АКФ:
${r_{xx2}(n) = \frac{A^4}{8} \cos{(\omega n)} + \bar{N} \delta{(N)}}$,
где мощность шума оценки ${\bar{N}}$ - будет значительно меньше.

Так же можно получить оценку АКФ на ${N}$ - шаге. На рисунках \ref{pic:lpc_1_iter},
\ref{pic:lpc_2_iter}, \ref{pic:lpc_3_iter} представлены оценки АКФ на шагах с 1 по 3.

\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_1_iter.eps}}
	\caption{Оценка АКФ на 1 итерации.}
	\label{pic:lpc_1_iter}
\end{figure}

\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_2_iter.eps}}
	\caption{Оценка АКФ на 2 итерации.}
	\label{pic:lpc_2_iter}
\end{figure}

\begin{figure}[H]
	\center\scalebox{0.9}{\includegraphics[width=1\linewidth]{lpc_3_iter.eps}}
	\caption{Оценка АКФ на 3 итерации.}
	\label{pic:lpc_3_iter}
\end{figure}

Представленный алгоритм позволяет значительно улучшить оценку АКФ. На рисунке \ref{pic:lpc_3_iter} представлена оценка АКФ на 3 итерации.
Результаты работы алгоритма уточнения поступают на вход алгоритма АР. АР алгоритм позволяет точно оценить частоту гармонического сигнала.

В данной работе предложена оптимизированная версия данного алгоритма, позволяющая применять его при обработке сигнала в реальном времени.

Для снижения вычислительных затрат указанный алгоритм предлагается реализовывать с использованием процедуры БПФ. 
Введем следующие обозначения: ${x}$ – вектор входного сигнала после снятия ПСП, ${F}$ – матрица прямого преобразования Фурье, ${F^{-1}}$- матрица обратного преобразования Фурье.
Оценку АКФ на первом шаге можно получить следующим образом:

\begin{center}
\begin{equation}
	\label{eq:akf_1}
	\hat{r}_1 = F^{-1}\left[ Fx \cdot (Fx)^* \right] = F^{-1} \left[ \left| Fx \right| ^2 \right]
\end{equation}
\end{center}

Здесь знак ${(\cdot)}$  означает поэлементное перемножение векторов, ${\left| Fx \right| ^2}$ - поэлементное возведение модуля комплексного числа в квадрат, ${*}$ - означает
комплексное сопряжение.  Следуя алгоритму, изложенному в \cite{ostanin_akf} вычислим оценку АКФ от ${\hat{r}_1}$:

\begin{center}
\begin{eqnarray}
	\label{eq:akf_2}
	\hat{r}_2 & = & F^{-1}\left[ F \hat{r}_1 \cdot (F \hat{r}_1)^* \right] = \nonumber \\
		& = & F^{-1}	\left[ 
				FF^{-1} \left[
						\left| Fx \right| ^2
					\right]
						\cdot \left( FF^{-1} \left[ \left| Fx \right| ^2 \right]
					\right) ^*
			\right] = \nonumber \\
		& = & F^{-1} \left[ \left| Fx \right| ^2 \cdot \left[ \left| Fx \right| ^2 \right] ^* \right] =  \nonumber \\
		& = & F^{-1} \left[ \left| Fx \right| ^4 \right]
\end{eqnarray}
\end{center}

Рассуждая аналогично, можно показать, что уточненная оценка АКФ на K-ом шаге алгоритма, рассмотренного в \cite{ostanin_akf}
может быть получена без использования итераций с помощью выражения:

\begin{center}
\begin{equation}
	\label{eq:akf_3}
	\hat{r}_K = F^{-1}\left[ \left| Fx \right| ^{2^K} \right]
\end{equation}
\end{center}

Схематически алгоритм получения уточненной оценки АКФ на третьем шаге представлен на рисунке \ref{pic:akf_pic}.

\begin{figure}[H]
	\center\scalebox{0.8}{\includegraphics[width=1\linewidth]{akf_fft.eps}}
	\caption{Усовершенствованный итеративный алгоритм получения АКФ}
	\label{pic:akf_pic}
\end{figure}


\subsection{Алгоритм обнаружения и оценки параметров ШПС в условиях интерференции (DMA + уточненный АР)}
\subsection{Результаты численного моделирования}
\subsection{Результаты обработки сигнала GPS}

\subsection*{Выводы}

\newpage
