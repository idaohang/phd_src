\section{Глава 3. Алгоритм оценки фазы и частоты ШПС сигнала на основе АР-модели на фоне интерференции}

\subsection{Оценка фазы ПСП в ШПС}
\label{sec_dma_real}
Для использования параметрического метода оценки частоты необходимо восстановить гармоническую форму сигнала. Для этого
нужно получить оценку фазы ПСП и произвести повторную модуляцию входной смеси. Получить оценку фазы ПСП не прибегая к перебору по частоте,
позволяет алгоритм Delay and Multiply Approach (DMA). Данный алгоритм был представлен в статье и книге американского ученого Дж.Цуя \cite{lin_dma, tsui}

Особенностью данного алгоритма является то, что он позволяет свести перебор в двумерной области неопределенности:
промежуточная частота, фаза ПСП к перебору только по фазе ПСП.
Пусть входная смесь представлена выражением \ref{eq:unknown}, а количество источников ${N}$ равно двум. Тогда выражение \ref{eq:unknown} можно переписать в виде:
\begin{center}
\begin{equation}
	\label{eq:dma_cdma_for_2}
	x(m) =	A_1 g_1(t + \tau_1) exp \left[ j \left( \tilde{\omega_1} m + \phi_1 (m) \right) \right]
		+ A_2 g_2(t + \tau_2) exp \left[ j \left(  \tilde{\omega_2} m + \phi_2 (m) \right) \right] + n(m) 
\end{equation}
\end{center}

Следуя алгоритму DMA, необходимо умножить сигнал на задержанную копию:
\begin{center}
\begin{equation}
	\label{eq:dma_cdma_1}
	xx(m) = x(m)x(m+\tau)^*,
\end{equation}
\end{center}
где ${*}$ - операция комплексного сопряжения, ${\tau}$ - задержка между копиями сигнала. Подставляя \ref{eq:dma_cdma_for_2} в \ref{eq:dma_cdma_1} получается выражение:
\begin{center}
\begin{eqnarray}
	\label{eq:dma_cdma_2}
	x(m) & = &[ A_1 g_1(m + \tau_1) exp \left[ j \left( \tilde{\omega_1} m + \phi_1 (m) \right) \right] + \nonumber \\
	     & + & A_2 g_2(m + \tau_2) exp \left[ j \left(  \tilde{\omega_2} m + \phi_2 (m) \right) \right] + n(m) ] + \nonumber \\
	     & + & [A_1 g_1(m + \tau + \tau_1) exp \left[ j \left( \tilde{\omega_1} (m + \tau) + \phi_1 (m + \tau) \right) \right]  + \nonumber \\
	     & + & A_2 g_2(m + \tau + \tau_2) exp \left[ j \left(  \tilde{\omega_2} (m + \tau) + \phi_2 (m + \tau) \right) \right] + n(m + \tau)]^*
\end{eqnarray}
\end{center}

В выражении \ref{eq:dma_cdma_2} полезным слагаемым является:
\begin{center}
\begin{equation}
	\label{eq:dma_cdma_3}
	xx_{sig}(m) = A^2_1 g_{11}(m) exp[j (\tilde {\omega_1} \tau)],
\end{equation}
\end{center}
где ${g_{11}(m)}$ - новая ПСП (структура новых ПСП поясняется ниже). 

Интерференционные помехи, не содержащие полезный сигнал, могут быть представлены как:
\begin{center}
\begin{eqnarray}
	\label{eq:dma_cdma_4}
	xx_{intf}(m) & = & A_{12} g_{12}(m) exp \left[ j \left( \tilde{\omega_1} m - \tilde{\omega_2}(m + \tau) + \phi_{12} (m) \right) \right] + \nonumber \\
		& + & A_{21} g_{12}(m) exp \left[ j \left( \tilde{\omega_2} m - \tilde{\omega_1}(m + \tau) + \phi_{21} (m) \right) \right] + \nonumber \\
		& + & A^2_2 g_{22}(m) exp[j (\tilde {\omega_2} \tau)],
\end{eqnarray}
\end{center}
где ${A_{12}=A_1 A_2}$, ${g_{12}(m)=g(m+\tau+1)g_2(m+\tau_2+\tau)}$, а ${g_{21} = g_2(m+\tau_2)g_1(m+\tau_1+\tau)}$, а ${g_{22}(m)}$ - новая ПСП для источника сигнала 2.

Также появляются новые шумовые компоненты:
\begin{center}
\begin{eqnarray}
	\label{eq:dma_cdma_5}
	xx_{noise}(m) & = & A_{1} g_{1}(m + \tau_1) exp \left[ j \left( \tilde{\omega_1} m + \phi_{1} (m) \right) \right] n(m + \tau) + \nonumber \\
		& + & A_{2} g_{2}(m + \tau_2) exp \left[ j \left( \tilde{\omega_2} m + \phi_{2} (m) \right) \right] n(m + \tau)^* + \nonumber \\
		& = & n(m)A_{1} g_{1}(m + \tau_1 + \tau) exp \left[ j \left( \tilde{\omega_1} (m + \tau) + \phi_{1} (m + \tau) \right) \right] + \nonumber \\
		& + & n(m)A_{2} g_{2}(m + \tau_2 + \tau) exp \left[ j \left( \tilde{\omega_2} (m + \tau) + \phi_{2} (m + \tau) \right) \right] + \nonumber \\
		& + & n(m)n(m+\tau)
\end{eqnarray}
\end{center}

Таким образом \ref{eq:dma_cdma_2} можно переписать как смесь:
\begin{center}
\begin{equation}
	\label{eq:dma_cdma_6}
	xx(m) = xx_{sig}(m) + xx_{intf}(m) + xx_{noise}(m)
\end{equation}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Алгоритм оценки параметров ШПС в условиях интерференции}
\label{l:ssec3_dma_lpc_algo}

В данной работе предлагается объединить результаты работы алгоритма DMA, рассмотренного в разделе
\ref{sec_dma_real} и, предложенных в данной работе, усовершенствованного итеративного 
алгоритма уточнения АКФ (раздел \ref{sec_acf_fft}) гармонического сигнала и 
подхода для оценки частоты ПСП-модулированного сигнала при помощи АР-модели.

Схематично алгоритм изображен на рисунке \ref{pic4:dma_quadruple_lpc}

\begin{figure}[H]
\center\scalebox{1}{\includegraphics[width=1\linewidth]{dma_quadruple_lpc.eps}}
	\caption{Алгоритм обнаружения и оценки параметров ШПС в условиях интерференции (DMA + уточненный АР)}
	\label{pic4:dma_quadruple_lpc}
\end{figure}

Выходом алгоритма DMA является оценка фазы ПСП. Повторно модулируя входящий сигнал ПСП с полученной
фазой, можно восстановить гармонический сигнал. Для оценки частоты данного сигнала применяется
АР-метод. Но для оценки АР-методом, требуется точная оценка АКФ, которую можно получить
с помощью усовершенствованного итеративного алгоритма вычисления АКФ.

Рекомендации по выбору задержки ${\tau}$ и детали алгоритма DMA рассмотрены в разделе
\ref{sec1:dma_real}.

Предложенный алгоритм можно описать следующим набором шагов
\begin{itemize}
\item[Шаг 1.] Входной сигнал ${x(k)}$ умножается на задержанную копию ${x(t-\tau)}$. Так же
	на данном шаге можно производить когерентное накопление результата, для
	увеличения ОСШ.

	\begin{center}
	\begin{equation}
		%\label{}
		x_{new}(k) = \frac{C_{new}(k)}{2} \left(\cos (2\pi f \tau) - \cos \left[2 \pi f (2t - \tau)\right]\right)
	\end{equation}
	\end{center}

\item[Шаг 2.] Полученный сигнал ${x_{new}(k)}$ фильтруется ФВЧ для отсечения высокочастотной компоненты.
\item[Шаг 3.] Генерируется локальная ПСП ${C(k)}$ и умножается на задержанную копию ${C(k-\tau)}$.

	\begin{center}
	\begin{equation}
		%\label{}
		C_{new}(k) = C(k)C(k-\tau)
	\end{equation}
	\end{center}

\item[Шаг 4.] Отфильтрованный сигнал ${x_{filt}(k)}$ коррелируется с новой ПСП ${C_{new}(k)}$
	с использованием БПФ. Выход коррелятора сравнивается с заранее определенным порогом.

	\begin{center}
	\begin{equation}
		%\label{}
		x_{filt}(k) = \frac{C_{new}(k)}{2} \cos (2\pi f \tau)
	\end{equation}
	\end{center}

	\subitem{\bf{Если}}  значение оказалось больше порогового {\bf{то}},
		принимается решение о наличии сигнала. Полученное значение фазы ПСП  - ${m}$ запоминается.
		Перейти на шаг 5.
	\subitem{\bf{Иначе}} 
		Принимается решение об отсутствии сигнала.
\item[Шаг 5.] Входной сигнал ${x(k)}$ модулируется ПСП ${C(k-m)}$. В результате получаем гармонический
	сигнал ${x_{cos}(k)}$ с неизвестной частотой.
\item[Шаг 6.] Для увеличения ОСШ сигнала ${x_{cos}(k)}$ вычисляется значение уточненное значение АКФ
	по алгоритму, предложенному в разделе \ref{l:ssec3_quadruple}.
\item[Шаг 7.] Определяются коэффициенты АР-модели ${\hat{a_1}, \hat{a_2}}$, по формуле \ref{eq:lpc_a_estimation}. 
	Вычисляется резонансная частота ${\omega_0 = 2 \pi f}$ и определяется квадрат модуля частотного отклика АР-модели для этой частоты. 
\end{itemize}

Количество умножений требуемых для оценки частоты одного источника при помощи алгоритма Delay and Multiply Approach и АР-модели:
\begin{enumerate}
\item Алгоритм DMA:
	\begin{center}
	\begin{equation}
		%\label{}
		OP_{DMA} = 8NlogN + 6N
	\end{equation}
	\end{center}
\item Усовершенствованный итеративный алгоритм получения АКФ:
	\begin{center}
	\begin{equation}
		%\label{}
		OP_{ACF} = 8NlogN + (k+2)N
	\end{equation}
	\end{center}
\item Оценка параметра АР-методом:
	\subitem Обращение АКФ матрицы 2x2 элементов требует: 5 умножений, 1 обращение и 1 сложение;
	\subitem Вычисление параметров АР-модели: 4 умножения, 2 сложения;
	\subitem Вычисление полюсов передаточной функции АР-модели: 2 умножения, 3 сложения, 1 операция извлечения корня.

	\begin{center}
	\begin{equation}
		%\label{}
		OP_{AR} = 51
	\end{equation}
	\end{center}
\end{enumerate}

Следует отметить, что в пункте 3 произведены допущения: стоимость 1 операции деления равна 10 операциям умножения, стоимость операции извлечения
корня составляет 20 операций умножения, стоимость сложения не учитывается.
Общее количество умножений для оценки частоты при помощи развиваемого подхода при учете трех итераций уточнения АКФ:
\begin{center}
\begin{equation}
	%\label{}
	OP_{DMA\_ACF\_AR} = 16NlogN + 11N
\end{equation}
\end{center}

%%%%%%%%%%%%%%
\subsection{Сравнительный анализ с параллельным коррелятором}
Структура программного приемника СПИ  Navstar GPS рассмотрена в \cite{tsui}. После стадии оценки параметров сигнала и сравнения с порогом, оценка
частоты для заданного источника поступает в модуль уточнения частоты. Уточненная частота и фаза ПСП поступают в ФАПЧ.
Одним из параметров системы ФАПЧ является шумовая полоса. Этот параметр определяет количество теплового шума попадающего в систему ФАПЧ.
Широкая шумовая полоса позволяет системе ФАПЧ быстро войти в синхронизм, но также ведет к существенному ухудшению характеристик системы ФАПЧ за счет возрастания уровня теплового шума. 

Область синхронизации частоты, в пределах которой не обеспечивается срыв синхронизации, определяется как \cite{spilker-book}:
\begin{center}
\begin{equation}
	\label{eq:pll_omega_m}
	\Delta \omega_m \approx 2 \omega_n (\zeta+0.6),
\end{equation}
\end{center}
где ${\omega_n}$ - собственная частота системы ФАПЧ, ${\zeta}$ - коэффициент демпфирования(${\zeta > 0.3}$).

Примем ${\zeta = 0.707}$. Данное значение   близко к оптимальному \cite{tsui, spilker-book}, тогда ${\Delta \omega_m = 2.614 \omega_n}$.
Собственная частота системы ФАПЧ вычисляется по формуле:
\begin{center}
\begin{equation}
	\label{eq:pll_omega_n}
	\omega_n = \frac{8 \zeta B_L}{4 \zeta^2 + 1},
\end{equation}
\end{center}
где ${B_L}$ - шумовая полоса.

Традиционный подход к оценке параметров широкополосного сигнала предусматривает корреляцию входного сигнала и набора локальных копий сигнала шагом 1 кГц.
Для стационарного приемника СПИ Navstar GPS диапазон смещения частоты, обусловленный Доплеровским эффектом, находится в диапазоне ${\pm 5}$ кГц \cite{tsui, shahtarin-book}.
Таким образом, для получения оценки с точностью 1 кГц необходимо провести поиск в 11 ячейках. В каждой ячейке нам необходимо ${N}$-комплексных умножений.
Для наземных приемников типовое значение ${B_L=20}$ Гц \cite{tsui}. Область синхронизации из выражений \ref{eq:pll_omega_m} и \ref{eq:pll_omega_n}
${\Delta \omega_m = 100}$ рад/с (примерно 16 Гц).
В данном случае необходима стадия уточнения частоты. Следует отметить, что заданная точность может быть достигнута даже на сигнале с достаточно
низким ОСШ при оценке АР-методом после уточнения АКФ – рисунок 8.

Схема традиционного приемника изображена на рисунке 9.

Рисунок 9. Схема традиционного приемника.

Количество комплексных умножений требуемых для оценки частоты одного источника при помощи алгоритма БПФ:
\begin{enumerate}
\item ${NlogN}$ - преобразование Фурье входного сигнала;
\item ${N}$ - умножение входного сигнала и локальной копии в Фурье домене;
\item ${N}$ - обратное преобразование Фурье.
\item ${4NlogN}$ - действительных умножений – обратное преобразование Фурье. 
\end{enumerate}

\begin{center}
\begin{equation}
	\label{eq:op_fft}
	OP_{FFT} = NlogN + 11(N + NlogN) = 12NlogN + 11N
\end{equation}
\end{center}

Алгоритм уточнения частоты описан в \cite{tsui}. Данный алгоритм основан на усреднении фазы и требует дополнительной оперативной памяти (ОЗУ) приемника для
хранения 5 миллисекунд данных при обработке одного источника. Оперативная память потребляет значительное количество энергии, поэтому снижение количества
необходимой ОЗУ является важной задачей при разработке портативных приемников. Также обработка 5 мс данных повышает вероятность встретить переход бита
внутри данных – это ведет к дополнительным сложностям при реализации программных приемников сигнала Navstar GPS.

Количество умножений, требуемых для уточнения частоты одного источника:
\begin{enumerate}
\item Повторная модуляция 5 мс данных: ${5N}$ умножений;
\item Повышение точности до 400 Гц: ${6N}$ умножений;
\item Вычисление ДПФ в частотной позиции на длине: ${10N}$ умножений.
\end{enumerate}

\begin{center}
\begin{equation}
	\label{eq:op_fine}
	OP_{FINE} = 21N
\end{equation}
\end{center}

Общее количество операций умножения (количество операций комплексного умножения необходимо домножить на 4):  .
\begin{center}
\begin{equation}
	\label{eq:op_fine_fft}
	OP_{FFT\_FINE} = 48NlogN + 65N
\end{equation}
\end{center}

\subsection{Сравнение точности оценки частоты с границей Крамера-Рао}

\subsection{Выводы}

\newpage
