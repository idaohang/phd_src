clc; clear all;

modelPath = '..\\..\\src\\tests\\tsim\\model';
addpath(modelPath) ;

M = 51 ;
fft_length = 2048 ;

%%%%%%

w_hann = hann(M) ;
W_hann = abs(fft(w_hann, fft_length)) ;

fig1 = figure(1);
    subplot(1, 2, 1), plot(w_hann), xlim([1 M]), grid on;
    xlabel(sprintf('???????\n?)')) ; ylabel('?????????') ; 
    phd_figure_style(gcf) ;
    subplot(1, 2, 2), semilogy(linspace(0, 0.5, fft_length / 2), W_hann(1 : fft_length / 2)); xlim([0 0.5]); grid on,
    xlabel(sprintf('??????????????? ???????\n?)')) ; ylabel('??????????? ??????????????, ??') ; 
    phd_figure_style(gcf) ;
    print(fig1, 'various_windows_fig1.eps')

%%%%%%%%    
    
w_hamming = hamming(M) ;
W_hamming = abs(fft(w_hamming, fft_length)) ;

fig2 = figure(2);
    subplot(1, 2, 1), plot(w_hamming), xlim([1 M]), grid on;
    xlabel(sprintf('???????\n?)')) ; ylabel('?????????') ; 
    phd_figure_style(gcf) ;
    subplot(1, 2, 2), semilogy(linspace(0, 0.5, fft_length / 2), W_hamming (1 : fft_length / 2)); xlim([0 0.5]); grid on;
    xlabel(sprintf('??????????????? ???????\n?)')) ; ylabel('??????????? ??????????????, ??') ; 
    phd_figure_style(gcf) ;
    print(fig2, 'various_windows_fig2.eps')

%%%%%%%%
    
w_bart = bartlett(M) ;
W_bart = abs(fft(w_bart, fft_length)) ;    

fig3 = figure(3) ;
    subplot(1, 2, 1), plot(w_bart), xlim([1 M]), grid on;
    xlabel(sprintf('???????\n?)')) ; ylabel('?????????') ; 
    phd_figure_style(gcf) ;    
    subplot(1, 2, 2), semilogy(linspace(0, 0.5, fft_length / 2), W_bart((1 : fft_length / 2))); xlim([0 0.5]); grid on;
    xlabel(sprintf('??????????????? ???????\n?)')) ; ylabel('??????????? ??????????????, ??') ; 
    phd_figure_style(gcf) ;
    print(fig3, 'various_windows_fig3.eps')

    
%%%%%%%%%   
    
w_rect = ones(M,1) ;
W_rect = abs(fft(w_rect(2:end-1), fft_length)) ;    
    
fig4 = figure(4) ;
    subplot(1, 2, 1), plot(w_rect), xlim([1 M]), grid on;
    xlabel(sprintf('???????\n?)')) ; ylabel('?????????') ; 
    phd_figure_style(gcf) ;    
    subplot(1, 2, 2), semilogy(linspace(0, 0.5, fft_length / 2), W_rect((1 : fft_length / 2))); xlim([0 0.5]); grid on;   
    xlabel(sprintf('??????????????? ???????\n?)')) ; ylabel('??????????? ??????????????, ??') ; 
    phd_figure_style(gcf) ;
    print(fig4, 'various_windows_fig4.eps')

% remove model path
rmpath(modelPath) ;